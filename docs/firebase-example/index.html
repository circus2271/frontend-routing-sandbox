<!DOCTYPE html>
<html>
<head>
    <title>–£–º–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫</title>
    <script type="module">
        // –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –Ω—É–∂–Ω—ã–µ –º–æ–¥—É–ª–∏ Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
        import { getFirestore, collection, addDoc, query, where, orderBy, onSnapshot } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
        
        // –í–ê–® firebaseConfig
        const firebaseConfig = {
            apiKey: "AIzaSyC5YF0PVuFaADucXXkpuMJexABXgf8v0AU",
            authDomain: "shoping-de115.firebaseapp.com",
            projectId: "shoping-de115",
            storageBucket: "shoping-de115.firebasestorage.app",
            messagingSenderId: "861754687557",
            appId: "1:861754687557:web:c0608c8b43bda654d3632c",
            measurementId: "G-J9BFS0PM58"
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        
        // –î–µ–ª–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–º–∏ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö
        window.fbauth = auth;
        window.fbdb = db;
        window.fbauthFunctions = {
            createUserWithEmailAndPassword,
            signInWithEmailAndPassword, 
            signOut,
            onAuthStateChanged
        };
        window.fbfirestoreFunctions = {
            collection,
            addDoc,
            query,
            where,
            orderBy,
            onSnapshot
        };
        
        console.log("‚úÖ Firebase –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!");
    </script>
    
    <style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 40px auto; padding: 20px; background: #f5f5f5; }
        .container { background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1 { color: #4285f4; text-align: center; }
        input { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 5px; box-sizing: border-box; }
        button { background: #4285f4; color: white; border: none; padding: 12px 20px; margin: 5px; border-radius: 5px; cursor: pointer; }
        button:hover { background: #3367d6; }
        .section { margin: 25px 0; padding: 20px; border: 2px solid #e0e0e0; border-radius: 8px; }
        #items-list { list-style: none; padding: 0; }
        #items-list li { background: #f8f9fa; padding: 10px; margin: 5px 0; border-radius: 5px; border-left: 4px solid #4285f4; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üõí –£–º–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫</h1>
        
        <div class="section" id="auth-section">
            <h3>–í—Ö–æ–¥ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h3>
            <input type="email" id="email" placeholder="–í–∞—à email">
            <input type="password" id="password" placeholder="–ü–∞—Ä–æ–ª—å">
            <button onclick="signUp()">–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</button>
            <button onclick="signIn()">–í–æ–π—Ç–∏</button>
        </div>

        <div class="section hidden" id="app-section">
            <h3>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, <span id="user-email"></span>! </h3>
            <div style="display: flex; gap: 10px;">
                <input type="text" id="item-input" placeholder="–ß—Ç–æ –Ω—É–∂–Ω–æ –∫—É–ø–∏—Ç—å?" style="flex: 1;">
                <button onclick="addItem()">–î–æ–±–∞–≤–∏—Ç—å</button>
            </div>
            <h4>–ú–æ–π —Å–ø–∏—Å–æ–∫:</h4>
            <ul id="items-list"></ul>
            <button onclick="signOut()" style="background: #ea4335;">–í—ã–π—Ç–∏</button>
        </div>
    </div>

    <script>
        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º
        async function signUp() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            try {
                await window.fbauthFunctions.createUserWithEmailAndPassword(window.fbauth, email, password);
                alert(' –ê–∫–∫–∞—É–Ω—Ç —Å–æ–∑–¥–∞–Ω! –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –≤–æ–π—Ç–∏.');
            } catch (error) {
                alert('‚ùå –û—à–∏–±–∫–∞: ' + error.message);
            }
        }

        async function signIn() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            try {
                await window.fbauthFunctions.signInWithEmailAndPassword(window.fbauth, email, password);
            } catch (error) {
                alert('‚ùå –û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞: ' + error.message);
            }
        }

        async function signOut() {
            try {
                await window.fbauthFunctions.signOut(window.fbauth);
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≤—ã—Ö–æ–¥–∞:', error);
            }
        }

        async function addItem() {
            const itemInput = document.getElementById('item-input');
            const item = itemInput.value.trim();
            const user = window.fbauth.currentUser;
            
            if (item && user) {
                try {
                    await window.fbfirestoreFunctions.addDoc(
                        window.fbfirestoreFunctions.collection(window.fbdb, 'shoppingItems'), 
                        {
                            text: item,
                            userId: user.uid,
                            createdAt: new Date(),
                            completed: false
                        }
                    );
                    itemInput.value = '';
                    itemInput.focus();
                } catch (error) {
                    alert('‚ùå –û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è: ' + error.message);
                }
            } else if (!item) {
                alert(' –í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞!');
            }
        }

        // –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
        window.fbauthFunctions.onAuthStateChanged(window.fbauth, (user) => {
            const authSection = document.getElementById('auth-section');
            const appSection = document.getElementById('app-section');
            
            if (user) {
                authSection.classList.add('hidden');
                appSection.classList.remove('hidden');
                document.getElementById('user-email').textContent = user.email;
                loadItems(user);
            } else {
                authSection.classList.remove('hidden');
                appSection.classList.add('hidden');
                document.getElementById('email').value = '';
                document.getElementById('password').value = '';
            }
        });

        // –ó–∞–≥—Ä—É–∑–∫–∞ items –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
        function loadItems(user) {
            const itemsList = document.getElementById('items-list');
            
            const q = window.fbfirestoreFunctions.query(
                window.fbfirestoreFunctions.collection(window.fbdb, 'shoppingItems'),
                window.fbfirestoreFunctions.where('userId', '==', user.uid),
                window.fbfirestoreFunctions.orderBy('createdAt', 'desc')
            );
            
            window.fbfirestoreFunctions.onSnapshot(q, (snapshot) => {
                itemsList.innerHTML = '';
                
                snapshot.forEach((doc) => {
                    const item = doc.data();
                    const li = document.createElement('li');
                    li.textContent = item.text;
                    itemsList.appendChild(li);
                });
                
                if (snapshot.empty) {
                    const li = document.createElement('li');
                    li.textContent = '–°–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫ –ø—É—Å—Ç. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—ã–π —Ç–æ–≤–∞—Ä!';
                    li.style.color = '#666';
                    li.style.fontStyle = 'italic';
                    itemsList.appendChild(li);
                }
            });
        }

        // –ë—ã—Å—Ç—Ä—ã–π –≤–≤–æ–¥ –ø–æ Enter
        document.getElementById('password').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') signIn();
        });
        
        document.getElementById('item-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') addItem();
        });
    </script>
</body>
</html>
–°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–∞–π–ª. –ì–æ—Ç–æ–≤–æ. –¢–µ–ø–µ—Ä—å —Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ. –ï—Å–ª–∏ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç, –º—ã –º–æ–∂–µ–º –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —ç—Ç–∞–ø—É.